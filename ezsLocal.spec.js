const should = require("should");
const sinon = require("sinon");
const request = require("./ezsLocal.js").request;
const expect = require("expect");
const unit = require("./ezsLocal.js");
const ezs = require("ezs");
const url = require("url");
const from = require("from");
const fs = require("fs");

/* eslint-disable */
let dataTest = [
  JSON.stringify({
    total: 27,
    scroll: "1m",
    scrollId: "DnF1ZXJ5VGhlbkZldGNoVQAAAAAAF33LFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABf2nBZtWGNXUnowUVJqbTkybE9hOUg3NXZ3AAAAAAAX508WTXZIU1RwSDdSQjZpT2NnWUtocWJiUQAAAAAAF33KFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABf2nRZtWGNXUnowUVJqbTkybE9hOUg3NXZ3AAAAAAAXfcwWb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF6DPFlVFNHpjY29KUURLX1UwakVzTlU5SEEAAAAAABd9zRZvY3g2YXRvQVR6aURycnpheHVIMDlBAAAAAAAXklUWcEJSNXNYaXlTR2VGN0dvM1QzQkdwdwAAAAAAF-dQFk12SFNUcEg3UkI2aU9jZ1lLaHFiYlEAAAAAABeg0BZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAXklcWcEJSNXNYaXlTR2VGN0dvM1QzQkdwdwAAAAAAF_aeFm1YY1dSejBRUmptOTJsT2E5SDc1dncAAAAAABeg0hZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAXoNEWVUU0emNjb0pRREtfVTBqRXNOVTlIQQAAAAAAF-dRFk12SFNUcEg3UkI2aU9jZ1lLaHFiYlEAAAAAABfnUhZNdkhTVHBIN1JCNmlPY2dZS2hxYmJRAAAAAAAXfc4Wb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF-dTFk12SFNUcEg3UkI2aU9jZ1lLaHFiYlEAAAAAABd9zxZvY3g2YXRvQVR6aURycnpheHVIMDlBAAAAAAAXklQWcEJSNXNYaXlTR2VGN0dvM1QzQkdwdwAAAAAAF_afFm1YY1dSejBRUmptOTJsT2E5SDc1dncAAAAAABeg1BZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAX51QWTXZIU1RwSDdSQjZpT2NnWUtocWJiUQAAAAAAF6DTFlVFNHpjY29KUURLX1UwakVzTlU5SEEAAAAAABeg1hZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAXfdEWb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF33QFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABeg1RZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAXklYWcEJSNXNYaXlTR2VGN0dvM1QzQkdwdwAAAAAAF_agFm1YY1dSejBRUmptOTJsT2E5SDc1dncAAAAAABeg1xZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAX9qEWbVhjV1J6MFFSam05MmxPYTlINzV2dwAAAAAAF_aiFm1YY1dSejBRUmptOTJsT2E5SDc1dncAAAAAABeg2BZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAXoNoWVUU0emNjb0pRREtfVTBqRXNOVTlIQQAAAAAAF6DZFlVFNHpjY29KUURLX1UwakVzTlU5SEEAAAAAABf2pBZtWGNXUnowUVJqbTkybE9hOUg3NXZ3AAAAAAAX9qMWbVhjV1J6MFFSam05MmxPYTlINzV2dwAAAAAAF5JYFnBCUjVzWGl5U0dlRjdHbzNUM0JHcHcAAAAAABf2pRZtWGNXUnowUVJqbTkybE9hOUg3NXZ3AAAAAAAX51YWTXZIU1RwSDdSQjZpT2NnWUtocWJiUQAAAAAAF-dVFk12SFNUcEg3UkI2aU9jZ1lLaHFiYlEAAAAAABd90hZvY3g2YXRvQVR6aURycnpheHVIMDlBAAAAAAAXfdQWb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF33TFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABd91hZvY3g2YXRvQVR6aURycnpheHVIMDlBAAAAAAAXoNsWVUU0emNjb0pRREtfVTBqRXNOVTlIQQAAAAAAF-dZFk12SFNUcEg3UkI2aU9jZ1lLaHFiYlEAAAAAABfnWBZNdkhTVHBIN1JCNmlPY2dZS2hxYmJRAAAAAAAX51cWTXZIU1RwSDdSQjZpT2NnWUtocWJiUQAAAAAAF33VFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABeg3BZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAXoN0WVUU0emNjb0pRREtfVTBqRXNOVTlIQQAAAAAAF6DgFlVFNHpjY29KUURLX1UwakVzTlU5SEEAAAAAABf2phZtWGNXUnowUVJqbTkybE9hOUg3NXZ3AAAAAAAXklkWcEJSNXNYaXlTR2VGN0dvM1QzQkdwdwAAAAAAF_anFm1YY1dSejBRUmptOTJsT2E5SDc1dncAAAAAABeg3hZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAX9qgWbVhjV1J6MFFSam05MmxPYTlINzV2dwAAAAAAF33XFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABd92hZvY3g2YXRvQVR6aURycnpheHVIMDlBAAAAAAAXoN8WVUU0emNjb0pRREtfVTBqRXNOVTlIQQAAAAAAF33YFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABeg4RZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAX9qkWbVhjV1J6MFFSam05MmxPYTlINzV2dwAAAAAAF6DjFlVFNHpjY29KUURLX1UwakVzTlU5SEEAAAAAABeg4hZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAX51oWTXZIU1RwSDdSQjZpT2NnWUtocWJiUQAAAAAAF33ZFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABeSTxZwQlI1c1hpeVNHZUY3R28zVDNCR3B3AAAAAAAXfdsWb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF5JQFnBCUjVzWGl5U0dlRjdHbzNUM0JHcHcAAAAAABfnWxZNdkhTVHBIN1JCNmlPY2dZS2hxYmJRAAAAAAAX51wWTXZIU1RwSDdSQjZpT2NnWUtocWJiUQAAAAAAF_aqFm1YY1dSejBRUmptOTJsT2E5SDc1dncAAAAAABeSURZwQlI1c1hpeVNHZUY3R28zVDNCR3B3AAAAAAAXfdwWb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF5JTFnBCUjVzWGl5U0dlRjdHbzNUM0JHcHcAAAAAABfnXRZNdkhTVHBIN1JCNmlPY2dZS2hxYmJRAAAAAAAXfd8Wb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF33dFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABeSUhZwQlI1c1hpeVNHZUY3R28zVDNCR3B3AAAAAAAXfd4Wb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF5JaFnBCUjVzWGl5U0dlRjdHbzNUM0JHcHc=",
    nextScrollURI: "https://api-v5.istex.fr/document/?q=language:gle&size=15&defaultOperator=OR&scroll=1m&scrollId=DnF1ZXJ5VGhlbkZldGNoVQAAAAAAF33LFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABf2nBZtWGNXUnowUVJqbTkybE9hOUg3NXZ3AAAAAAAX508WTXZIU1RwSDdSQjZpT2NnWUtocWJiUQAAAAAAF33KFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABf2nRZtWGNXUnowUVJqbTkybE9hOUg3NXZ3AAAAAAAXfcwWb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF6DPFlVFNHpjY29KUURLX1UwakVzTlU5SEEAAAAAABd9zRZvY3g2YXRvQVR6aURycnpheHVIMDlBAAAAAAAXklUWcEJSNXNYaXlTR2VGN0dvM1QzQkdwdwAAAAAAF-dQFk12SFNUcEg3UkI2aU9jZ1lLaHFiYlEAAAAAABeg0BZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAXklcWcEJSNXNYaXlTR2VGN0dvM1QzQkdwdwAAAAAAF_aeFm1YY1dSejBRUmptOTJsT2E5SDc1dncAAAAAABeg0hZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAXoNEWVUU0emNjb0pRREtfVTBqRXNOVTlIQQAAAAAAF-dRFk12SFNUcEg3UkI2aU9jZ1lLaHFiYlEAAAAAABfnUhZNdkhTVHBIN1JCNmlPY2dZS2hxYmJRAAAAAAAXfc4Wb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF-dTFk12SFNUcEg3UkI2aU9jZ1lLaHFiYlEAAAAAABd9zxZvY3g2YXRvQVR6aURycnpheHVIMDlBAAAAAAAXklQWcEJSNXNYaXlTR2VGN0dvM1QzQkdwdwAAAAAAF_afFm1YY1dSejBRUmptOTJsT2E5SDc1dncAAAAAABeg1BZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAX51QWTXZIU1RwSDdSQjZpT2NnWUtocWJiUQAAAAAAF6DTFlVFNHpjY29KUURLX1UwakVzTlU5SEEAAAAAABeg1hZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAXfdEWb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF33QFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABeg1RZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAXklYWcEJSNXNYaXlTR2VGN0dvM1QzQkdwdwAAAAAAF_agFm1YY1dSejBRUmptOTJsT2E5SDc1dncAAAAAABeg1xZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAX9qEWbVhjV1J6MFFSam05MmxPYTlINzV2dwAAAAAAF_aiFm1YY1dSejBRUmptOTJsT2E5SDc1dncAAAAAABeg2BZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAXoNoWVUU0emNjb0pRREtfVTBqRXNOVTlIQQAAAAAAF6DZFlVFNHpjY29KUURLX1UwakVzTlU5SEEAAAAAABf2pBZtWGNXUnowUVJqbTkybE9hOUg3NXZ3AAAAAAAX9qMWbVhjV1J6MFFSam05MmxPYTlINzV2dwAAAAAAF5JYFnBCUjVzWGl5U0dlRjdHbzNUM0JHcHcAAAAAABf2pRZtWGNXUnowUVJqbTkybE9hOUg3NXZ3AAAAAAAX51YWTXZIU1RwSDdSQjZpT2NnWUtocWJiUQAAAAAAF-dVFk12SFNUcEg3UkI2aU9jZ1lLaHFiYlEAAAAAABd90hZvY3g2YXRvQVR6aURycnpheHVIMDlBAAAAAAAXfdQWb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF33TFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABd91hZvY3g2YXRvQVR6aURycnpheHVIMDlBAAAAAAAXoNsWVUU0emNjb0pRREtfVTBqRXNOVTlIQQAAAAAAF-dZFk12SFNUcEg3UkI2aU9jZ1lLaHFiYlEAAAAAABfnWBZNdkhTVHBIN1JCNmlPY2dZS2hxYmJRAAAAAAAX51cWTXZIU1RwSDdSQjZpT2NnWUtocWJiUQAAAAAAF33VFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABeg3BZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAXoN0WVUU0emNjb0pRREtfVTBqRXNOVTlIQQAAAAAAF6DgFlVFNHpjY29KUURLX1UwakVzTlU5SEEAAAAAABf2phZtWGNXUnowUVJqbTkybE9hOUg3NXZ3AAAAAAAXklkWcEJSNXNYaXlTR2VGN0dvM1QzQkdwdwAAAAAAF_anFm1YY1dSejBRUmptOTJsT2E5SDc1dncAAAAAABeg3hZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAX9qgWbVhjV1J6MFFSam05MmxPYTlINzV2dwAAAAAAF33XFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABd92hZvY3g2YXRvQVR6aURycnpheHVIMDlBAAAAAAAXoN8WVUU0emNjb0pRREtfVTBqRXNOVTlIQQAAAAAAF33YFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABeg4RZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAX9qkWbVhjV1J6MFFSam05MmxPYTlINzV2dwAAAAAAF6DjFlVFNHpjY29KUURLX1UwakVzTlU5SEEAAAAAABeg4hZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAX51oWTXZIU1RwSDdSQjZpT2NnWUtocWJiUQAAAAAAF33ZFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABeSTxZwQlI1c1hpeVNHZUY3R28zVDNCR3B3AAAAAAAXfdsWb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF5JQFnBCUjVzWGl5U0dlRjdHbzNUM0JHcHcAAAAAABfnWxZNdkhTVHBIN1JCNmlPY2dZS2hxYmJRAAAAAAAX51wWTXZIU1RwSDdSQjZpT2NnWUtocWJiUQAAAAAAF_aqFm1YY1dSejBRUmptOTJsT2E5SDc1dncAAAAAABeSURZwQlI1c1hpeVNHZUY3R28zVDNCR3B3AAAAAAAXfdwWb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF5JTFnBCUjVzWGl5U0dlRjdHbzNUM0JHcHcAAAAAABfnXRZNdkhTVHBIN1JCNmlPY2dZS2hxYmJRAAAAAAAXfd8Wb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF33dFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABeSUhZwQlI1c1hpeVNHZUY3R28zVDNCR3B3AAAAAAAXfd4Wb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF5JaFnBCUjVzWGl5U0dlRjdHbzNUM0JHcHc%3D",
    noMoreScrollResults: false,
    hits: [
      {
        title: "Tiomna Nuadh ar Dtighearna agus ar Slanuigheora Josa Criosd, ar na tharruing go firinneach as Gregis go Gaoidheilg. Re Ulliam O Domhnuill. Noch ata anois ar mhaithe choitchinn Ghaoidhealtacht Albann, athruighte go haireach as an litir Eireandha, go min-litre shoi-leighidh Romhanta; Maille re Suim agus brìgh na Ccaibidleach os a ccionn, a n Tiodaluibh aithghearr; le R. Kirke, M.A.",
        id: "68CC07C5EF07732FB7CC8826025A8DED9EF5DB8C"
      },
      {
        title: "Catechismus, seu Doctrina christiana, latino-hibernica",
        id: "E295A5516709AD9CE7F412EC25E6169CD650AF69"
      },
      {
        title: "Tiomna Nuadh ar dTighearna agus ar Slanuigheora Iósa Criosd",
        id: "709464D856D9028DCD46C1AF0F784CFF6D4FE8E5"
      },
      {
        title: "Christian catechism]",
        id: "969DF1819E7A8C294B14641D4FBFC59630BA04C9"
      },
      {
        title: "XCIX canons, or rules",
        id: "A19CD43F5E925B1E6BBFB4540363F085EDD399AF"
      },
      {
        title: "Emanuel leabhar ina bhfuil modh iarrata agus fhagala fhoirbhtheachda na beathadh riaghaltha",
        id: "3D2CF3A42DBC5ABF421325DDE6DD485105A7C6B7"
      },
      {
        title: "Seventeen Irish sermons, in an easy and familiar stile, on useful and necessary subjects, in English characters; As being the more Familiar to the Generality of our Irish Clergy. In which is included, a sermon On the joys of heaven. By the Rev. J. Gallagher, S.T.D.",
        id: "E71AF3A65DA248CEF5AD08708A8B1B82B8F5A501"
      },
      {
        title: "An soisgeal do reir Lucais, agus Gniovarha na Neasbal. = The gospel according to St. Luke, and the Acts of the Apostles.",
        id: "299B7E1103CBF546B82488E3D9C4F6838E5DE780"
      },
      {
        title: "Leabḣuir na Seintiomna ar na ttarrvʻng go gaiḋlig tre c̓úram & ḋúṫraś an Doctúir Uilliam Bedel, roiṁe so easbug Chille Móire a Nēirin̄, agus anois ar na ccur a ccló c̓um maiṫios pvʻblidhe na tīresin",
        id: "256F0635910238B3010EDE8D1E5D9900B20F7ECF"
      },
      {
        title: "aibidil gaoidheilge, [agus] caiticiosma",
        id: "B01D3D9A248966EE71659CAEF563C14AD30C9280"
      },
      {
        title: "Uiebat templo· & de decunit vivebant·",
        id: "1C0FDD25D723BAAAC8BAD0940D26AEC685808A0B"
      },
      {
        title: "Acts of the three theological virtues and contrition absolutely necessary to salvation; to which are annexed some other devout acts: ... Gniomhartha na ntri subhailce diadha agus croidh-bhruighidh ro riachtanacha chum slainte; ...",
        id: "E4780C32A15FB8DCAC8D5B5AA08F096EFDCC3684"
      },
      {
        title: "Biobla Naomhtha",
        id: "311C77C628ECE68961F86E08BF3CAC0E4909C2A4"
      },
      {
        title: "Seanmora ar na priom phoncibh, na chreideamh. Ar na Ttarung go Gaidhlig, agus ar na ccur a ccló a Lunnduin tre Ebhlin Everingham, 1711. = Sermons upon the principal points of religion, translated into Irish.",
        id: "A492DF2A97C6398E7FE9153749704CBBD5BC1635"
      },
      {
        title: "Lucerna fidelium, seu, Fasciculus decerptus ab authoribus magis versatis, qui tractarunt de doctrina Christiana",
        id: "11A5B83E22DCC84299997DCD329273220DC924A8"
      }
    ],
    aggregations: {}
  }),
  JSON.stringify({
    total: 27,
    scroll: "1m",
    scrollId: "DnF1ZXJ5VGhlbkZldGNoVQAAAAAAF33LFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABf2nBZtWGNXUnowUVJqbTkybE9hOUg3NXZ3AAAAAAAX508WTXZIU1RwSDdSQjZpT2NnWUtocWJiUQAAAAAAF33KFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABf2nRZtWGNXUnowUVJqbTkybE9hOUg3NXZ3AAAAAAAXfcwWb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF6DPFlVFNHpjY29KUURLX1UwakVzTlU5SEEAAAAAABd9zRZvY3g2YXRvQVR6aURycnpheHVIMDlBAAAAAAAXklUWcEJSNXNYaXlTR2VGN0dvM1QzQkdwdwAAAAAAF-dQFk12SFNUcEg3UkI2aU9jZ1lLaHFiYlEAAAAAABeg0BZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAXklcWcEJSNXNYaXlTR2VGN0dvM1QzQkdwdwAAAAAAF_aeFm1YY1dSejBRUmptOTJsT2E5SDc1dncAAAAAABeg0hZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAXoNEWVUU0emNjb0pRREtfVTBqRXNOVTlIQQAAAAAAF-dRFk12SFNUcEg3UkI2aU9jZ1lLaHFiYlEAAAAAABfnUhZNdkhTVHBIN1JCNmlPY2dZS2hxYmJRAAAAAAAXfc4Wb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF-dTFk12SFNUcEg3UkI2aU9jZ1lLaHFiYlEAAAAAABd9zxZvY3g2YXRvQVR6aURycnpheHVIMDlBAAAAAAAXklQWcEJSNXNYaXlTR2VGN0dvM1QzQkdwdwAAAAAAF_afFm1YY1dSejBRUmptOTJsT2E5SDc1dncAAAAAABeg1BZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAX51QWTXZIU1RwSDdSQjZpT2NnWUtocWJiUQAAAAAAF6DTFlVFNHpjY29KUURLX1UwakVzTlU5SEEAAAAAABeg1hZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAXfdEWb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF33QFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABeg1RZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAXklYWcEJSNXNYaXlTR2VGN0dvM1QzQkdwdwAAAAAAF_agFm1YY1dSejBRUmptOTJsT2E5SDc1dncAAAAAABeg1xZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAX9qEWbVhjV1J6MFFSam05MmxPYTlINzV2dwAAAAAAF_aiFm1YY1dSejBRUmptOTJsT2E5SDc1dncAAAAAABeg2BZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAXoNoWVUU0emNjb0pRREtfVTBqRXNOVTlIQQAAAAAAF6DZFlVFNHpjY29KUURLX1UwakVzTlU5SEEAAAAAABf2pBZtWGNXUnowUVJqbTkybE9hOUg3NXZ3AAAAAAAX9qMWbVhjV1J6MFFSam05MmxPYTlINzV2dwAAAAAAF5JYFnBCUjVzWGl5U0dlRjdHbzNUM0JHcHcAAAAAABf2pRZtWGNXUnowUVJqbTkybE9hOUg3NXZ3AAAAAAAX51YWTXZIU1RwSDdSQjZpT2NnWUtocWJiUQAAAAAAF-dVFk12SFNUcEg3UkI2aU9jZ1lLaHFiYlEAAAAAABd90hZvY3g2YXRvQVR6aURycnpheHVIMDlBAAAAAAAXfdQWb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF33TFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABd91hZvY3g2YXRvQVR6aURycnpheHVIMDlBAAAAAAAXoNsWVUU0emNjb0pRREtfVTBqRXNOVTlIQQAAAAAAF-dZFk12SFNUcEg3UkI2aU9jZ1lLaHFiYlEAAAAAABfnWBZNdkhTVHBIN1JCNmlPY2dZS2hxYmJRAAAAAAAX51cWTXZIU1RwSDdSQjZpT2NnWUtocWJiUQAAAAAAF33VFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABeg3BZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAXoN0WVUU0emNjb0pRREtfVTBqRXNOVTlIQQAAAAAAF6DgFlVFNHpjY29KUURLX1UwakVzTlU5SEEAAAAAABf2phZtWGNXUnowUVJqbTkybE9hOUg3NXZ3AAAAAAAXklkWcEJSNXNYaXlTR2VGN0dvM1QzQkdwdwAAAAAAF_anFm1YY1dSejBRUmptOTJsT2E5SDc1dncAAAAAABeg3hZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAX9qgWbVhjV1J6MFFSam05MmxPYTlINzV2dwAAAAAAF33XFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABd92hZvY3g2YXRvQVR6aURycnpheHVIMDlBAAAAAAAXoN8WVUU0emNjb0pRREtfVTBqRXNOVTlIQQAAAAAAF33YFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABeg4RZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAX9qkWbVhjV1J6MFFSam05MmxPYTlINzV2dwAAAAAAF6DjFlVFNHpjY29KUURLX1UwakVzTlU5SEEAAAAAABeg4hZVRTR6Y2NvSlFES19VMGpFc05VOUhBAAAAAAAX51oWTXZIU1RwSDdSQjZpT2NnWUtocWJiUQAAAAAAF33ZFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABeSTxZwQlI1c1hpeVNHZUY3R28zVDNCR3B3AAAAAAAXfdsWb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF5JQFnBCUjVzWGl5U0dlRjdHbzNUM0JHcHcAAAAAABfnWxZNdkhTVHBIN1JCNmlPY2dZS2hxYmJRAAAAAAAX51wWTXZIU1RwSDdSQjZpT2NnWUtocWJiUQAAAAAAF_aqFm1YY1dSejBRUmptOTJsT2E5SDc1dncAAAAAABeSURZwQlI1c1hpeVNHZUY3R28zVDNCR3B3AAAAAAAXfdwWb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF5JTFnBCUjVzWGl5U0dlRjdHbzNUM0JHcHcAAAAAABfnXRZNdkhTVHBIN1JCNmlPY2dZS2hxYmJRAAAAAAAXfd8Wb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF33dFm9jeDZhdG9BVHppRHJyemF4dUgwOUEAAAAAABeSUhZwQlI1c1hpeVNHZUY3R28zVDNCR3B3AAAAAAAXfd4Wb2N4NmF0b0FUemlEcnJ6YXh1SDA5QQAAAAAAF5JaFnBCUjVzWGl5U0dlRjdHbzNUM0JHcHc=",
    noMoreScrollResults: true,
    hits: [
      {
        title: "Christian doctrine, or, The foundation of Christian religion",
        id: "879693512D8E30A145E9833AA7851EFEA12B995C"
      },
      {
        title: "Tiomna Nuadh ar dtighearna agus ar slanuigheora Josa Criosd, ar na tharruing go fʹirinneach as greigis go gaoidheilg. Re Villiamo Domhnuill. Noch atʹa anois ar mhaithe choitchnn Ghaʹodhealtacht albann, ʹathruighte go haireach as an litir Eʹireandha, go mion-litre shoi-lʹeighidh Romhanta; maille re suim agus brʹigh na ccaibidleach ʹos a ccionn, a nTiodaluibh aithghearr; le R. Kirke, M.A",
        id: "170D7C840BBA6ED756BE40C33B05617FBE842AE5"
      },
      {
        title: "co[m]pendious [buik] of godlie psalmes and spirit[uall sangis]",
        id: "E7D377B5436FAA99142DF032A8F81B5157FD8DDF"
      },
      {
        title: "An teagask creestye, agus paidreagha na mainne agus an tranona.",
        id: "068F4F1061D43B4A1F09F4338808E8D64E31228F"
      },
      {
        title: "An teagask creestye, agus paidreagha na mainne agus an tranona.",
        id: "B61AD033437C66E8BAE47CCA1E22BB03B6AC751B"
      },
      {
        title: "Leabhar na nurnaightheadh gcomhchoidchiond agus mheinisdraldachda na Sacrameinteadh, maille le gnathaighthibh agus le hordaighthibh oile, do réir eagalse na Sagsan",
        id: "DC1A6236871DD9B9723E4CD1A326FB06275B607C"
      },
      {
        title: "teagasg Criosdaidhe an so, arna chuma do Bonabhentura oeodhasa bráthair bos dord Dan Proinsias accolaisde S. Antoin a Lobhain",
        id: "797FD8320878E65CF871B6DF73288E201667B5C2"
      },
      {
        title: "Dan do rinne an brathar bos dórd S. Proinsias Bonabheantúra ó Heódhasa Gardián bráthar néiriónach Lobháin dfíorcharaid aridhe dhó, do thuit a neirikear, lé mergdh an tshaogail, 7 ainmian a kholnah",
        id: "C25B8404C8A198FADD86F88A9D10306C97B16655"
      },
      {
        title: "Parrthas an anma",
        id: "9CD8BBFD091AA4C95D52AFD303519DFB3C7BDB5C"
      },
      {
        title: "Scathan shacramuinte na haitridhe",
        id: "82548EBEBCE0F098CADB2D9240E1A10864ACE577"
      },
      {
        title: "S. Matthew. 20. Chapter",
        id: "112E03067592E7076AF3E9DC916634B5F80882FE"
      },
      {
        title: "Tiomna Nuadh ar dTighearna agus ar Slanaightheora Josa Criosd",
        id: "424C703B69956CA6DB31E4A09181485D61785C77"
      }
    ],
    aggregations: {}
  })
];
/* eslint-enable */

var v = 0;

function iterative() {
  console.log(v);
  return JSON.parse(dataTest[v++]);
}

var s = sinon.stub(request, "get");
s.yields(null, null,iterative());

ezs.use(unit);

describe("The scroll API request", () => {
  it("should return dataAPI", done => {
    from(["https://api-v5.istex.fr/document/?q=language:test"])
      .pipe(ezs("scroll"))
      .pipe(
        ezs((data, feed) => {

          if (data.noMoreScrollResults) {
            done();
          }

          feed.end();
        })
      );
  });
  // //.pipe(ezs("convertIstexQuery"))
  // //.pipe(process.stdout);
  // request.get("http://api-test.fr", (error, response, body) => {
  //   //console.log(body);

  //   request.get(body.nextScrollURI, (error, response, body) => {
  //     //console.log(body);
  //   });
  // });
});
